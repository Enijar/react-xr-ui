{"version":3,"file":"661.f5fc98d4.chunk.js","mappings":"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","sources":["webpack://react-xr-ui/./src/components/keyboard.tsx","webpack://react-xr-ui/./examples/examples/input.tsx","webpack://react-xr-ui/./src/components/interaction.tsx"],"sourcesContent":["import React from \"react\";\nimport type { Intersection } from \"three\";\nimport * as THREE from \"three\";\nimport { useFrame, useThree } from \"@react-three/fiber\";\nimport Layer from \"./layer\";\nimport Interaction from \"./interaction\";\n\ntype Props = {\n  onChange?: (value: string) => void;\n  backgroundColor?: string;\n  keyColor?: string;\n  keyHoverColor?: string;\n  enabled?: boolean;\n};\n\nconst ACTION = {\n  delete: \"delete\",\n  toggleCase: \"toggleCase\",\n} as const;\n\nexport default function Keyboard({\n  onChange,\n  backgroundColor = \"#000000\",\n  keyColor = \"#222222\",\n  keyHoverColor = \"#444444\",\n  enabled = true,\n}: Props) {\n  const capabilities = useThree((state) => state.gl.capabilities);\n  const anisotropy = React.useMemo(() => {\n    return capabilities.getMaxAnisotropy();\n  }, [capabilities]);\n\n  const onChangeRef = React.useRef(onChange);\n  React.useMemo(() => {\n    onChangeRef.current = onChange;\n  }, [onChange]);\n\n  const meshRef = React.useRef<THREE.Mesh<\n    THREE.PlaneGeometry,\n    THREE.MeshBasicMaterial\n  > | null>(null);\n\n  type Key = {\n    label: string;\n    value?: string;\n    action?: keyof typeof ACTION;\n    spanCols?: number;\n    spanRows?: number;\n  };\n\n  type State = {\n    uppercase: boolean;\n    pointer: { x: number; y: number };\n    value: string;\n    hitKey: Key | null;\n  };\n\n  const stateRef = React.useRef<State>({\n    uppercase: false,\n    pointer: { x: -1, y: -1 },\n    value: \"\",\n    hitKey: null,\n  });\n\n  type Layout = Array<Array<Array<Key | null>>>;\n\n  const layout = React.useMemo<Layout>(() => {\n    return [\n      [\n        [\n          { label: \"§\", value: \"§\" },\n          { label: \"±\", value: \"±\" },\n        ],\n        [\n          { label: \"1\", value: \"1\" },\n          { label: \"!\", value: \"!\" },\n        ],\n        [\n          { label: \"2\", value: \"2\" },\n          { label: \"@\", value: \"@\" },\n        ],\n        [\n          { label: \"3\", value: \"3\" },\n          { label: \"£\", value: \"£\" },\n        ],\n        [\n          { label: \"4\", value: \"4\" },\n          { label: \"$\", value: \"$\" },\n        ],\n        [\n          { label: \"5\", value: \"5\" },\n          { label: \"%\", value: \"%\" },\n        ],\n        [\n          { label: \"6\", value: \"6\" },\n          { label: \"^\", value: \"^\" },\n        ],\n        [\n          { label: \"7\", value: \"7\" },\n          { label: \"&\", value: \"&\" },\n        ],\n        [\n          { label: \"8\", value: \"8\" },\n          { label: \"*\", value: \"*\" },\n        ],\n        [\n          { label: \"9\", value: \"9\" },\n          { label: \"(\", value: \"(\" },\n        ],\n        [\n          { label: \"0\", value: \"0\" },\n          { label: \")\", value: \")\" },\n        ],\n        [\n          { label: \"-\", value: \"-\" },\n          { label: \"_\", value: \"_\" },\n        ],\n        [\n          { label: \"=\", value: \"=\" },\n          { label: \"+\", value: \"+\" },\n        ],\n        [{ label: \"⌫\", action: ACTION.delete }],\n      ],\n      [\n        [{ label: \"↹\", value: \"\\t\" }],\n        [\n          { label: \"q\", value: \"q\" },\n          { label: \"Q\", value: \"Q\" },\n        ],\n        [\n          { label: \"w\", value: \"w\" },\n          { label: \"W\", value: \"W\" },\n        ],\n        [\n          { label: \"e\", value: \"e\" },\n          { label: \"E\", value: \"E\" },\n        ],\n        [\n          { label: \"r\", value: \"r\" },\n          { label: \"R\", value: \"R\" },\n        ],\n        [\n          { label: \"t\", value: \"t\" },\n          { label: \"T\", value: \"T\" },\n        ],\n        [\n          { label: \"y\", value: \"y\" },\n          { label: \"Y\", value: \"Y\" },\n        ],\n        [\n          { label: \"u\", value: \"u\" },\n          { label: \"U\", value: \"U\" },\n        ],\n        [\n          { label: \"i\", value: \"i\" },\n          { label: \"I\", value: \"I\" },\n        ],\n        [\n          { label: \"o\", value: \"o\" },\n          { label: \"O\", value: \"O\" },\n        ],\n        [\n          { label: \"p\", value: \"p\" },\n          { label: \"P\", value: \"P\" },\n        ],\n        [\n          { label: \"[\", value: \"[\" },\n          { label: \"{\", value: \"{\" },\n        ],\n        [\n          { label: \"]\", value: \"]\" },\n          { label: \"}\", value: \"}\" },\n        ],\n        [{ label: \"↵\", value: \"\\n\", spanRows: 2 }],\n      ],\n      [\n        [{ label: \"⇪\", action: ACTION.toggleCase }],\n        [\n          { label: \"a\", value: \"a\" },\n          { label: \"A\", value: \"A\" },\n        ],\n        [\n          { label: \"s\", value: \"s\" },\n          { label: \"S\", value: \"S\" },\n        ],\n        [\n          { label: \"d\", value: \"d\" },\n          { label: \"D\", value: \"D\" },\n        ],\n        [\n          { label: \"f\", value: \"f\" },\n          { label: \"F\", value: \"F\" },\n        ],\n        [\n          { label: \"g\", value: \"g\" },\n          { label: \"G\", value: \"G\" },\n        ],\n        [\n          { label: \"h\", value: \"h\" },\n          { label: \"H\", value: \"H\" },\n        ],\n        [\n          { label: \"j\", value: \"j\" },\n          { label: \"J\", value: \"J\" },\n        ],\n        [\n          { label: \"k\", value: \"k\" },\n          { label: \"K\", value: \"K\" },\n        ],\n        [\n          { label: \"l\", value: \"l\" },\n          { label: \"L\", value: \"L\" },\n        ],\n        [\n          { label: \";\", value: \";\" },\n          { label: \":\", value: \":\" },\n        ],\n        [\n          { label: \"'\", value: \"'\" },\n          { label: '\"', value: '\"' },\n        ],\n        [\n          { label: \"\\\\\", value: \"\\\\\" },\n          { label: \"|\", value: \"|\" },\n        ],\n      ],\n      [\n        [null],\n        [\n          { label: \"`\", value: \"`\" },\n          { label: \"~\", value: \"~\" },\n        ],\n        [\n          { label: \"z\", value: \"z\" },\n          { label: \"Z\", value: \"Z\" },\n        ],\n        [\n          { label: \"x\", value: \"x\" },\n          { label: \"X\", value: \"X\" },\n        ],\n        [\n          { label: \"c\", value: \"c\" },\n          { label: \"C\", value: \"C\" },\n        ],\n        [\n          { label: \"v\", value: \"v\" },\n          { label: \"V\", value: \"V\" },\n        ],\n        [\n          { label: \"b\", value: \"b\" },\n          { label: \"B\", value: \"B\" },\n        ],\n        [\n          { label: \"n\", value: \"n\" },\n          { label: \"N\", value: \"N\" },\n        ],\n        [\n          { label: \"m\", value: \"m\" },\n          { label: \"M\", value: \"M\" },\n        ],\n        [\n          { label: \",\", value: \",\" },\n          { label: \"<\", value: \"<\" },\n        ],\n        [\n          { label: \".\", value: \".\" },\n          { label: \">\", value: \">\" },\n        ],\n        [\n          { label: \"?\", value: \"?\" },\n          { label: \"/\", value: \"/\" },\n        ],\n      ],\n      [[null], [null], [null], [{ label: \"SPACE\", value: \" \", spanCols: 7 }]],\n    ];\n  }, []);\n\n  const maxRowLength = React.useMemo(() => {\n    return layout.reduce((maxRowLength, cols) => {\n      return Math.max(maxRowLength, cols.length);\n    }, 0);\n  }, [layout]);\n\n  const ctx = React.useMemo(() => {\n    const canvas = document.createElement(\"canvas\");\n    return canvas.getContext(\"2d\")!;\n  }, []);\n\n  const settings = React.useMemo(() => {\n    const kh = ctx.canvas.width / maxRowLength;\n    return {\n      width: 1,\n      height: (kh * layout.length) / ctx.canvas.width,\n      scale: 1,\n      textScale: 0.4,\n      canvasScale: 1024,\n    };\n  }, [ctx.canvas.width, layout, maxRowLength]);\n\n  React.useMemo(() => {\n    ctx.canvas.width = settings.width * settings.canvasScale;\n    ctx.canvas.height = settings.height * settings.canvasScale;\n    ctx.canvas.style.textRendering = \"geometricPrecision\";\n  }, [ctx.canvas, settings.width, settings.height, settings.canvasScale]);\n\n  useFrame(() => {\n    const mesh = meshRef.current;\n    if (mesh === null) return;\n    if (mesh.material.map === null) return;\n    const [w, h] = [ctx.canvas.width, ctx.canvas.height];\n\n    const keySize = w / maxRowLength;\n\n    // Clear\n    ctx.clearRect(0, 0, w, h);\n\n    // Background\n    ctx.fillStyle = backgroundColor;\n    ctx.fillRect(0, 0, w, h);\n\n    // Layout\n    layout.forEach((cols, rowIndex) => {\n      cols.forEach((keys, colIndex) => {\n        let key = keys[0];\n        if (stateRef.current.uppercase) {\n          key = keys[1] ?? keys[0];\n        }\n        if (key === null) return;\n        if (key.label === undefined) return;\n\n        function isPointerHit(\n          kx: number,\n          ky: number,\n          kw: number,\n          kh: number\n        ): boolean {\n          const px = stateRef.current.pointer.x * w;\n          const py = stateRef.current.pointer.y * h;\n          return px >= kx && px <= kx + kw && py >= ky && py <= ky + kh;\n        }\n\n        const spanCols = key.spanCols ?? 1;\n        const spanRows = key.spanRows ?? 1;\n        const kw = keySize * spanCols;\n        const kh = keySize * spanRows;\n        const kx = keySize * colIndex;\n        const ky = keySize * rowIndex;\n        const cx = kx + kw / 2;\n        const cy = ky + kh / 2;\n        const hit = isPointerHit(kx, ky, kw, kh);\n        if (hit) {\n          stateRef.current.hitKey = key;\n        }\n        ctx.fillStyle = hit ? keyHoverColor : keyColor;\n        ctx.fillRect(kx, ky, kw, kh);\n        ctx.font = `${Math.min(kw, kh) * settings.textScale}px system-ui`;\n        ctx.fillStyle = \"#ffffff\";\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillText(key.label, cx, cy);\n      });\n    });\n\n    // Paint\n    mesh.material.map.needsUpdate = true;\n  });\n\n  const setPointer = React.useCallback((intersection: Intersection) => {\n    stateRef.current.pointer.x = intersection.uv.x;\n    stateRef.current.pointer.y = 1 - intersection.uv.y;\n  }, []);\n\n  return (\n    <Interaction\n      enabled={enabled}\n      onOver={setPointer}\n      onMove={setPointer}\n      onOut={() => {\n        stateRef.current.pointer.x = -1;\n        stateRef.current.pointer.y = -1;\n      }}\n      onDown={(intersection) => {\n        setPointer(intersection);\n        if (stateRef.current.hitKey === null) return;\n        if (stateRef.current.hitKey.value !== undefined) {\n          // todo: account for cursor position\n          stateRef.current.value += stateRef.current.hitKey.value;\n        }\n        if (stateRef.current.hitKey.action !== undefined) {\n          switch (stateRef.current.hitKey.action) {\n            case ACTION.delete:\n              // todo: account for cursor position\n              stateRef.current.value = stateRef.current.value.slice(0, -1);\n              break;\n            case ACTION.toggleCase:\n              stateRef.current.uppercase = !stateRef.current.uppercase;\n              break;\n          }\n        }\n        if (onChangeRef.current !== undefined) {\n          onChangeRef.current(stateRef.current.value);\n        }\n      }}\n    >\n      <Layer width={settings.width} height={settings.height} visible={enabled}>\n        <mesh ref={meshRef} scale={settings.scale} renderOrder={999999}>\n          <planeGeometry args={[settings.width, settings.height]} />\n          <meshBasicMaterial depthWrite={false}>\n            <canvasTexture\n              attach=\"map\"\n              image={ctx.canvas}\n              anisotropy={anisotropy}\n            />\n          </meshBasicMaterial>\n        </mesh>\n      </Layer>\n    </Interaction>\n  );\n}\n","import React from \"react\";\nimport Example from \"@/components/example\";\nimport { Layer, Keyboard } from \"react-xr-ui\";\nimport ViewCode from \"@/components/view-code\";\n\nexport default function Input() {\n  const [name, setName] = React.useState(\"\");\n\n  return (\n    <>\n      <Example>\n        <Layer flexDirection=\"column\" gap={0.05}>\n          <Layer\n            width={1}\n            height={0.1}\n            fontSize={1}\n            textContent=\"Enter your name\"\n            textAlign=\"center\"\n          />\n          <Layer\n            width={1}\n            height={0.1}\n            fontSize={0.5}\n            textContent={name}\n            textAlign=\"center\"\n          />\n          <Keyboard onChange={setName} />\n        </Layer>\n      </Example>\n      <ViewCode pathname=\"input\" />\n    </>\n  );\n}\n","import React from \"react\";\nimport type { Intersection } from \"three\";\nimport { Interactive, useXR, XRInteractionEvent } from \"@react-three/xr\";\nimport { ThreeEvent } from \"@react-three/fiber\";\n\ntype Fn = (intersection: Intersection, intersections: Intersection[]) => void;\n\ntype Props = {\n  children: React.ReactNode;\n  onMove?: Fn;\n  onOver?: Fn;\n  onOut?: Fn;\n  onDown?: Fn;\n  onUp?: Fn;\n  enabled?: boolean;\n};\n\nexport default function Interaction({\n  children,\n  onMove,\n  onOver,\n  onOut,\n  onDown,\n  onUp,\n  enabled = true,\n}: Props) {\n  const isPresenting = useXR((state) => state.isPresenting);\n\n  const handleVrInteraction = React.useCallback(\n    (fn?: Fn) => {\n      return (event: XRInteractionEvent) => {\n        if (!isPresenting) return;\n        if (!enabled) return;\n        if (!fn) return;\n        fn(event.intersection, event.intersections);\n      };\n    },\n    [isPresenting, enabled, onDown, onUp, onMove, onOver, onOut]\n  );\n\n  const handleWebInteraction = React.useCallback(\n    (fn?: Fn) => {\n      return (event: ThreeEvent<PointerEvent>) => {\n        if (isPresenting) return;\n        if (!enabled) return;\n        if (!fn) return;\n        event.stopPropagation();\n        fn(event.intersections[0], event.intersections);\n      };\n    },\n    [isPresenting, enabled, onDown, onUp, onMove, onOver, onOut]\n  );\n\n  return (\n    <Interactive\n      onSelectStart={handleVrInteraction(onDown)}\n      onSelectEnd={handleVrInteraction(onUp)}\n      onMove={handleVrInteraction(onMove)}\n      onHover={handleVrInteraction(onOver)}\n      onBlur={handleVrInteraction(onOut)}\n    >\n      <group\n        onPointerDown={handleWebInteraction(onDown)}\n        onPointerUp={handleWebInteraction(onUp)}\n        onPointerMove={handleWebInteraction(onMove)}\n        onPointerOver={handleWebInteraction(onOver)}\n        onPointerOut={handleWebInteraction(onOut)}\n      >\n        {children}\n      </group>\n    </Interactive>\n  );\n}\n"],"names":["ACTION","delete","toggleCase","Keyboard","_ref","onChange","backgroundColor","keyColor","keyHoverColor","enabled","capabilities","useThree","state","gl","anisotropy","React","getMaxAnisotropy","onChangeRef","current","meshRef","stateRef","uppercase","pointer","x","y","value","hitKey","layout","label","action","spanRows","spanCols","maxRowLength","reduce","cols","Math","max","length","ctx","document","createElement","getContext","settings","width","height","canvas","scale","textScale","canvasScale","style","textRendering","useFrame","mesh","material","map","w","h","keySize","clearRect","fillStyle","fillRect","forEach","rowIndex","keys","colIndex","key","undefined","kw","kh","kx","ky","cx","cy","hit","px","py","isPointerHit","font","min","textAlign","textBaseline","fillText","needsUpdate","setPointer","intersection","uv","Interaction","onOver","onMove","onOut","onDown","slice","Layer","visible","ref","renderOrder","args","depthWrite","attach","image","Input","name","setName","Example","flexDirection","gap","fontSize","textContent","ViewCode","pathname","children","onUp","isPresenting","useXR","handleVrInteraction","fn","event","intersections","handleWebInteraction","stopPropagation","Interactive","onSelectStart","onSelectEnd","onHover","onBlur","onPointerDown","onPointerUp","onPointerMove","onPointerOver","onPointerOut"],"sourceRoot":""}