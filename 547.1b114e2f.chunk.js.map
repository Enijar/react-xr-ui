{"version":3,"file":"547.1b114e2f.chunk.js","mappings":"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","sources":["webpack://react-xr-ui/./lib/hooks/use-render-order.tsx","webpack://react-xr-ui/./lib/components/layer.tsx","webpack://react-xr-ui/./lib/services/layout.ts","webpack://react-xr-ui/./lib/services/interactive.ts","webpack://react-xr-ui/./lib/services/update.ts","webpack://react-xr-ui/./src/components/example.tsx"],"sourcesContent":["import * as React from \"react\";\n\nlet lastRenderOrder = -1;\n\nexport default function useRenderOrder() {\n  return React.useMemo(() => {\n    return ++lastRenderOrder;\n  }, []);\n}\n","import React from \"react\";\nimport * as THREE from \"three\";\nimport { RootState } from \"@react-three/fiber\";\nimport canvasTxt from \"canvas-txt\";\nimport { mergeRefs } from \"react-merge-refs\";\nimport useRenderOrder from \"../hooks/use-render-order\";\nimport layout from \"../services/layout\";\nimport updateManager from \"../services/update\";\nimport { BorderArray, LayerContextType, LayerProps } from \"../types\";\nimport interactive from \"../services/interactive\";\n\nconst LayerContext = React.createContext<LayerContextType>({\n  parentUuid: null,\n  currentChildren: [],\n  addChild() {},\n  removeChild() {},\n});\n\nconst DEFAULT_BACKGROUND_POSITION: LayerProps[\"backgroundPosition\"] = [0, 0];\n\nfunction Layer(\n  {\n    zIndex = 0,\n    resolution = 2048,\n    visible = true,\n    autoLayout = true,\n    width = 1,\n    height = 1,\n    opacity = 1,\n    backgroundColor = \"transparent\",\n    backgroundImage,\n    backgroundSize,\n    backgroundPosition = DEFAULT_BACKGROUND_POSITION,\n    borderRadius = 0,\n    borderWidth = 0,\n    borderColor = \"transparent\",\n    flexDirection = \"row\",\n    alignItems = \"center\",\n    justifyContent = \"center\",\n    gap = 0,\n    textContent,\n    textAlign = \"left\",\n    justifyText = false,\n    verticalAlign = \"top\",\n    color = \"white\",\n    fontFamily = \"system-ui, sans-serif\",\n    fontSize = 0.1,\n    fontWeight = \"normal\",\n    childIndex,\n    children,\n    onPointerMove,\n    onPointerOver,\n    onPointerOut,\n    onPointerDown,\n    onPointerUp,\n    ...props\n  }: LayerProps,\n  ref: React.ForwardedRef<THREE.Group>\n) {\n  const renderOrder = useRenderOrder();\n\n  const groupRef = React.useRef<THREE.Group>(null);\n  const materialRef = React.useRef<THREE.MeshBasicMaterial>(null);\n  const childrenGroupRef = React.useRef<THREE.Group>(null);\n\n  const layerContext = React.useContext(LayerContext);\n\n  const uuid = React.useMemo(() => {\n    return THREE.MathUtils.generateUUID();\n  }, []);\n\n  React.useEffect(() => {\n    if (layerContext.parentUuid === null) return;\n    layerContext.addChild({ width, height, index: childIndex, uuid });\n    return () => {\n      layerContext.removeChild(uuid);\n    };\n  }, [width, height, childIndex, layerContext.parentUuid]);\n\n  React.useEffect(() => {\n    interactive.add({\n      uuid,\n      object: groupRef.current,\n      onPointerMove,\n      onPointerOver,\n      onPointerOut,\n      onPointerDown,\n      onPointerUp,\n    });\n  }, [\n    uuid,\n    onPointerMove,\n    onPointerOver,\n    onPointerOut,\n    onPointerDown,\n    onPointerUp,\n  ]);\n\n  React.useEffect(() => {\n    return () => {\n      interactive.remove(uuid);\n    };\n  }, [uuid]);\n\n  // Create 2d canvas context\n  const ctx = React.useMemo<CanvasRenderingContext2D>(() => {\n    const canvas = document.createElement(\"canvas\");\n    return canvas.getContext(\"2d\");\n  }, []);\n\n  // Set canvas size\n  React.useMemo(() => {\n    ctx.canvas.width = Math.max(1, Math.floor(width * resolution));\n    ctx.canvas.height = Math.max(1, Math.floor(height * resolution));\n  }, [ctx.canvas, width, height, resolution]);\n\n  // Create canvas texture with the newly created canvas;\n  // this will be used as the texture for the plane\n  const canvasTexture = React.useMemo(() => {\n    const canvasTexture = new THREE.CanvasTexture(ctx.canvas);\n    canvasTexture.anisotropy = 16;\n    return canvasTexture;\n  }, [ctx.canvas, width, height]);\n\n  const images = React.useMemo(() => {\n    const backgroundImage = new Image();\n    return { backgroundImage };\n  }, []);\n\n  // Set source for background image\n  React.useMemo(() => {\n    if (!backgroundImage) return;\n    images.backgroundImage.src = backgroundImage;\n  }, [images.backgroundImage, backgroundImage]);\n\n  const update = React.useCallback(() => {\n    // Useful vars\n    const w = ctx.canvas.width;\n    const h = ctx.canvas.height;\n    const d2r = Math.PI / 180; // degrees to radians\n    const res = (w + h) / 2;\n    const { mapLinear } = THREE.MathUtils;\n\n    ctx.globalCompositeOperation = \"source-over\";\n\n    ctx.clearRect(0, 0, w, h);\n\n    // Border radius\n    {\n      const isArray = Array.isArray(borderRadius);\n      const array = borderRadius as BorderArray;\n      const number = borderRadius as number;\n      let [tl = 0, tr = 0, br = 0, bl = 0] = isArray\n        ? array\n        : [number, number, number, number];\n      tl *= res;\n      tr *= res;\n      br *= res;\n      bl *= res;\n      ctx.beginPath();\n      ctx.moveTo(tl, 0);\n      ctx.lineTo(w - tr, 0);\n      ctx.arc(w - tr, tr, tr, d2r * 270, d2r * 360);\n      ctx.lineTo(w, h - br);\n      ctx.arc(w - br, h - br, br, 0, d2r * 90);\n      ctx.lineTo(bl, h);\n      ctx.arc(bl, h - bl, bl, d2r * 90, d2r * 180);\n      ctx.lineTo(0, tl);\n      ctx.arc(tl, tl, tl, d2r * 180, d2r * 270);\n      ctx.closePath();\n    }\n\n    ctx.globalAlpha = opacity;\n\n    // Background color\n    ctx.fillStyle = backgroundColor;\n    ctx.lineWidth = borderWidth * res * 2;\n    ctx.fill();\n\n    const ox = borderWidth * res;\n    const oy = borderWidth * res;\n\n    // Background image\n    if (backgroundImage !== undefined) {\n      const x = backgroundPosition[0];\n      const y = backgroundPosition[1];\n      const sx = 0;\n      const sy = 0;\n      const sw = images.backgroundImage.width;\n      const sh = images.backgroundImage.height;\n      const ir = sw / sh;\n      const cr = w / h;\n      let dw = sw;\n      let dh = sh;\n      switch (backgroundSize) {\n        case \"stretch\":\n          dw = w;\n          dh = h;\n          break;\n        case \"contain\":\n          dw = w - ox * 2;\n          dh = h - oy * 2;\n          if (ir > cr) {\n            dh = dw / ir;\n          } else {\n            dw = dh * ir;\n          }\n          break;\n        case \"cover\":\n          dw = w - ox * 2;\n          dh = h - oy * 2;\n          if (ir < cr) {\n            dh = dw / ir;\n          } else {\n            dw = dh * ir;\n          }\n          break;\n      }\n      const dx = ox + mapLinear(x, 0, 1, 0, w - ox * 2 - dw);\n      const dy = oy + mapLinear(y, 0, 1, 0, h - oy * 2 - dh);\n      ctx.save();\n      ctx.clip();\n      ctx.drawImage(images.backgroundImage, sx, sy, sw, sh, dx, dy, dw, dh);\n      ctx.restore();\n    }\n\n    // Typography\n    if (textContent !== undefined) {\n      canvasTxt.font = fontFamily;\n      canvasTxt.fontSize = fontSize * Math.min(w, h);\n      canvasTxt.lineHeight = null;\n      canvasTxt.align = textAlign;\n      canvasTxt.vAlign = verticalAlign;\n      canvasTxt.justify = justifyText;\n      canvasTxt.fontWeight = fontWeight;\n      ctx.textBaseline = \"bottom\";\n      ctx.fillStyle = color;\n      canvasTxt.drawText(ctx, textContent, ox, oy, w - ox * 2, h - oy * 2);\n    }\n\n    // Fixes antialiasing issue\n    ctx.globalCompositeOperation = \"destination-out\";\n    ctx.stroke();\n    ctx.globalCompositeOperation = \"source-over\";\n    ctx.save();\n    ctx.clip();\n\n    ctx.strokeStyle = borderColor;\n    // Border\n    ctx.stroke();\n    ctx.restore();\n\n    // Make sure canvas texture gets updated\n    canvasTexture.needsUpdate = true;\n  }, [\n    ctx,\n    images,\n    borderWidth,\n    borderRadius,\n    borderColor,\n    backgroundImage,\n    backgroundColor,\n    backgroundPosition,\n    backgroundSize,\n    canvasTexture,\n    fontWeight,\n    fontSize,\n    fontFamily,\n    fontSize,\n    justifyContent,\n    verticalAlign,\n    textAlign,\n    textContent,\n    color,\n  ]);\n\n  React.useEffect(() => {\n    updateManager.add(uuid, update);\n    return () => updateManager.remove(uuid);\n  }, [uuid, update]);\n\n  const [currentChildren, setCurrentChildren] = React.useState<\n    LayerContextType[\"currentChildren\"]\n  >([]);\n\n  const childGroupRefs = React.useMemo(() => {\n    return currentChildren.map(() => React.createRef<THREE.Group>());\n  }, [currentChildren]);\n\n  // Layout calculations\n  React.useEffect(() => {\n    const size = { width, height };\n    size.width -= borderWidth * 2;\n    size.height -= borderWidth * 2;\n    let refs = [...childGroupRefs];\n    if ([\"column\", \"row-reverse\"].includes(flexDirection)) {\n      refs.reverse();\n    }\n    refs.forEach((ref, index) => {\n      if (flexDirection === \"column\") {\n        index = refs.length - 1 - index;\n      }\n      const [x, y] = layout({\n        currentChildren,\n        index,\n        flexDirection,\n        alignItems,\n        justifyContent,\n        gap,\n        size,\n      });\n      ref.current.position.x = x;\n      ref.current.position.y = y;\n    });\n  }, [\n    childGroupRefs,\n    currentChildren,\n    width,\n    height,\n    flexDirection,\n    alignItems,\n    justifyContent,\n    borderWidth,\n    gap,\n  ]);\n\n  const layerProviderValue = React.useMemo<LayerContextType>(() => {\n    return {\n      currentChildren,\n      parentUuid: uuid,\n      addChild(child) {\n        setCurrentChildren((currentChildren) => {\n          const nextCurrentChildren = [...currentChildren];\n          const index = currentChildren.findIndex((value) => {\n            return value.uuid === child.uuid;\n          });\n          if (index === -1) {\n            nextCurrentChildren.push({ ...child });\n          } else {\n            nextCurrentChildren[index] = { ...child };\n          }\n          return nextCurrentChildren.sort((a, b) => {\n            return a.index - b.index;\n          });\n        });\n      },\n      removeChild(uuid) {\n        setCurrentChildren((currentChildren) => {\n          return currentChildren.filter((value) => value.uuid !== uuid);\n        });\n      },\n    };\n  }, [currentChildren, uuid]);\n\n  React.useEffect(() => {\n    const childrenGroup = childrenGroupRef.current;\n    if (childrenGroup === null) return;\n    childrenGroup.traverse((object) => {\n      if (\n        object instanceof THREE.Mesh &&\n        object.material instanceof THREE.Material\n      ) {\n        object.material.transparent = true;\n        object.material.opacity = opacity;\n        object.material.needsUpdate = true;\n      }\n    });\n  }, [opacity]);\n\n  return (\n    <LayerContext.Provider value={layerProviderValue}>\n      <group ref={mergeRefs([ref, groupRef])} {...props} visible={visible}>\n        <mesh renderOrder={renderOrder + zIndex}>\n          <planeBufferGeometry args={[width, height]} />\n          <meshBasicMaterial\n            ref={materialRef}\n            side={THREE.FrontSide}\n            opacity={opacity}\n            transparent={true}\n            depthWrite={false}\n            map={canvasTexture}\n          />\n        </mesh>\n        <group renderOrder={renderOrder + zIndex + 1} ref={childrenGroupRef}>\n          {React.Children.map(children, (child, childIndex) => {\n            if (React.isValidElement(child)) {\n              return (\n                <group key={childIndex} ref={childGroupRefs[childIndex]}>\n                  {React.cloneElement(child, { ...child.props, childIndex })}\n                </group>\n              );\n            }\n            return child;\n          })}\n        </group>\n      </group>\n    </LayerContext.Provider>\n  );\n}\n\nconst ForwardedLayer = React.forwardRef(Layer);\nForwardedLayer.displayName = \"layer\";\nexport default ForwardedLayer;\n","import { Child, LayerProps, Size } from \"../types\";\n\ntype Axis = \"width\" | \"height\";\n\ntype Args = {\n  currentChildren: Child[];\n  index: number;\n  flexDirection: LayerProps[\"flexDirection\"];\n  alignItems: LayerProps[\"alignItems\"];\n  justifyContent: LayerProps[\"justifyContent\"];\n  gap: LayerProps[\"gap\"];\n  size: Size;\n};\n\nexport default function layout({\n  currentChildren,\n  index,\n  flexDirection,\n  alignItems,\n  justifyContent,\n  gap,\n  size,\n}: Args): [x: number, y: number] {\n  const childrenWidth = currentChildren.reduce((width, child) => {\n    return width + child.width;\n  }, 0);\n  const childrenHeight = currentChildren.reduce((height, child) => {\n    return height + child.height;\n  }, 0);\n  let x = 0;\n  let y = 0;\n  let contentSize = childrenWidth;\n  let axis: Axis = \"width\";\n  let axisInverted: Axis = \"height\";\n  if ([\"column\", \"column-reverse\"].includes(flexDirection)) {\n    axis = \"height\";\n    axisInverted = \"width\";\n    contentSize = childrenHeight;\n  }\n  if (\n    currentChildren.length > 0 &&\n    ![\"space-between\", \"space-around\"].includes(justifyContent)\n  ) {\n    contentSize += gap * (currentChildren.length - 1);\n  }\n  /**\n   * justifyContent\n   */\n  if (justifyContent === \"start\") {\n    x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - size[axis];\n    if (flexDirection === \"column\") {\n      x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - contentSize;\n    }\n    for (let i = 1; i <= index; i++) {\n      x +=\n        currentChildren[i - 1][axis] * 0.5 +\n        currentChildren[i][axis] * 0.5 +\n        gap;\n    }\n  }\n  if (justifyContent === \"center\") {\n    x = currentChildren[0][axis] * 0.5 - contentSize * 0.5;\n    for (let i = 1; i <= index; i++) {\n      x +=\n        currentChildren[i - 1][axis] * 0.5 +\n        currentChildren[i][axis] * 0.5 +\n        gap;\n    }\n  }\n  if (justifyContent === \"end\") {\n    x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - contentSize;\n    if (flexDirection === \"column\") {\n      x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - size[axis];\n    }\n    for (let i = 1; i <= index; i++) {\n      x +=\n        currentChildren[i - 1][axis] * 0.5 +\n        currentChildren[i][axis] * 0.5 +\n        gap;\n    }\n  }\n  if (justifyContent === \"space-between\") {\n    if (contentSize >= size[axis]) {\n      x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - size[axis];\n      for (let i = 1; i <= index; i++) {\n        x +=\n          currentChildren[i - 1][axis] * 0.5 + currentChildren[i][axis] * 0.5;\n      }\n    } else {\n      let spacing = Math.max(0, size[axis] - contentSize);\n      if (currentChildren.length === 0) {\n        spacing = 0;\n      } else if (spacing > 0) {\n        spacing /= currentChildren.length - 1;\n      }\n      x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - size[axis];\n      for (let i = 1; i <= index; i++) {\n        x +=\n          currentChildren[i - 1][axis] * 0.5 +\n          currentChildren[i][axis] * 0.5 +\n          spacing;\n      }\n    }\n  }\n  if (justifyContent === \"space-around\") {\n    if (contentSize >= size[axis]) {\n      x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - size[axis];\n      for (let i = 1; i <= index; i++) {\n        x +=\n          currentChildren[i - 1][axis] * 0.5 + currentChildren[i][axis] * 0.5;\n      }\n    } else {\n      let spacing = Math.max(0, size[axis] - contentSize);\n      if (currentChildren.length === 0) {\n        spacing = 0;\n      } else if (spacing > 0) {\n        spacing /= currentChildren.length + 1;\n      }\n      x = size[axis] * 0.5 + currentChildren[0][axis] * 0.5 - size[axis];\n      x += spacing;\n      for (let i = 1; i <= index; i++) {\n        x +=\n          currentChildren[i - 1][axis] * 0.5 +\n          currentChildren[i][axis] * 0.5 +\n          spacing;\n      }\n    }\n  }\n  /**\n   * alignItems\n   */\n  if (alignItems === \"start\") {\n    if ([\"row\", \"row-reverse\"].includes(flexDirection)) {\n      y = size[axisInverted] * 0.5 - currentChildren[index][axisInverted] * 0.5;\n    }\n    if ([\"column\", \"column-reverse\"].includes(flexDirection)) {\n      y =\n        size[axisInverted] * -0.5 + currentChildren[index][axisInverted] * 0.5;\n    }\n  }\n  if (alignItems === \"center\") {\n    // No calculation needed\n  }\n  if (alignItems === \"end\") {\n    if ([\"row\", \"row-reverse\"].includes(flexDirection)) {\n      y =\n        size[axisInverted] * -0.5 + currentChildren[index][axisInverted] * 0.5;\n    }\n    if ([\"column\", \"column-reverse\"].includes(flexDirection)) {\n      y = size[axisInverted] * 0.5 - currentChildren[index][axisInverted] * 0.5;\n    }\n  }\n  if ([\"column\", \"column-reverse\"].includes(flexDirection)) {\n    return [y, x];\n  }\n\n  return [x, y];\n}\n","import * as THREE from \"three\";\nimport { XRController } from \"@react-three/xr\";\n\ntype Interaction = {\n  uuid: string;\n  object?: THREE.Object3D;\n  onPointerMove?: (...args: any[]) => void;\n  onPointerOver?: (...args: any[]) => void;\n  onPointerOut?: (...args: any[]) => void;\n  onPointerDown?: (...args: any[]) => void;\n  onPointerUp?: (...args: any[]) => void;\n};\n\ntype Interactive = {\n  disabled: boolean;\n  enabled: boolean;\n  lastInteractionUuid: string;\n  interactions: Interaction[];\n  interactionsState: {\n    [uuid: string]: {\n      downFired: boolean;\n      upFired: boolean;\n      overFired: boolean;\n      outFired: boolean;\n    };\n  };\n  pointerDown: boolean;\n  cleanUp: boolean;\n  cleanDown: boolean;\n  cleanMove: boolean;\n  create: () => void;\n  add: (interaction: Interaction) => void;\n  remove: (uuid: string) => void;\n  handle: (camera: THREE.PerspectiveCamera, raycaster: THREE.Raycaster) => void;\n  update: (\n    camera: THREE.Camera,\n    raycaster: THREE.Raycaster,\n    controllers: XRController[]\n  ) => void;\n};\n\nconst matrix = new THREE.Matrix4();\n\nfunction hasPointerEvent(interaction: Interaction): boolean {\n  return (\n    interaction.onPointerMove !== undefined ||\n    interaction.onPointerOver !== undefined ||\n    interaction.onPointerOut !== undefined ||\n    interaction.onPointerDown !== undefined ||\n    interaction.onPointerUp !== undefined\n  );\n}\n\nfunction firePointerOver(interaction: Interaction): boolean {\n  if (!interaction.object) return;\n  const state = interactive.interactionsState[interaction.object.uuid];\n  return !state.overFired;\n}\n\nfunction firePointerOut(interaction: Interaction): boolean {\n  if (!interaction.object) return;\n  const state = interactive.interactionsState[interaction.object.uuid];\n  return state.overFired && !state.outFired;\n}\n\nfunction firePointerDown(interaction: Interaction): boolean {\n  if (!interactive.pointerDown) return false;\n  if (!interaction.object) return;\n  const state = interactive.interactionsState[interaction.object.uuid];\n  return !state.downFired;\n}\n\nfunction firePointerUp(interaction: Interaction): boolean {\n  if (interactive.pointerDown) return false;\n  if (!interaction.object) return;\n  const state = interactive.interactionsState[interaction.object.uuid];\n  return state.downFired && !state.upFired;\n}\n\nfunction firePointerMove(interaction: Interaction): boolean {\n  return true;\n}\n\nconst interactive: Interactive = {\n  disabled: false,\n  enabled: false,\n  lastInteractionUuid: \"\",\n  interactions: [],\n  interactionsState: {},\n  pointerDown: false,\n  cleanUp: false,\n  cleanDown: false,\n  cleanMove: false,\n  create() {\n    function onMove() {\n      interactive.enabled = true;\n      interactive.cleanMove = true;\n    }\n\n    function onDown() {\n      interactive.enabled = true;\n      interactive.pointerDown = true;\n      interactive.cleanDown = true;\n    }\n\n    function onUp() {\n      interactive.pointerDown = false;\n      interactive.cleanUp = true;\n    }\n\n    window.addEventListener(\"pointermove\", onMove);\n    window.addEventListener(\"pointerdown\", onDown);\n    window.addEventListener(\"pointerup\", onUp);\n    return () => {\n      window.removeEventListener(\"pointermove\", onMove);\n      window.removeEventListener(\"pointerdown\", onDown);\n      window.removeEventListener(\"pointerup\", onUp);\n    };\n  },\n  add(interaction) {\n    if (!hasPointerEvent(interaction)) return;\n    const index = interactive.interactions.findIndex((item) => {\n      return item.object?.uuid === interaction.object?.uuid;\n    });\n    if (index === -1 && interaction.object) {\n      interactive.interactionsState[interaction.object.uuid] = {\n        downFired: false,\n        upFired: false,\n        overFired: false,\n        outFired: false,\n      };\n      interactive.interactions.push(interaction);\n    }\n  },\n  remove(uuid) {\n    const index = interactive.interactions.findIndex((item) => {\n      return item.uuid === uuid;\n    });\n    if (index > -1) {\n      interactive.interactions.splice(index, 1);\n      document.body.style.cursor = \"auto\";\n    }\n  },\n  handle(camera, raycaster) {\n    for (let i = 0, length = interactive.interactions.length; i < length; i++) {\n      const interaction = interactive.interactions[i];\n      if (!interaction.object) continue;\n      const intersects = raycaster.intersectObject(interaction.object, true);\n      if (intersects.length === 0) {\n        if (firePointerOut(interaction)) {\n          interactive.interactionsState[interaction.object.uuid].outFired =\n            true;\n          interactive.interactionsState[interaction.object.uuid].overFired =\n            false;\n          if (interaction.onPointerOut !== undefined) {\n            interaction.onPointerOut();\n            document.body.style.cursor = \"auto\";\n          }\n        }\n        continue;\n      }\n      const intersect = intersects[0];\n      if (firePointerOver(interaction)) {\n        interactive.interactionsState[interaction.object.uuid].overFired = true;\n        interactive.interactionsState[interaction.object.uuid].outFired = false;\n        if (interaction.onPointerOver !== undefined) {\n          interaction.onPointerOver(intersect);\n          document.body.style.cursor = \"pointer\";\n        }\n      }\n      if (firePointerDown(interaction)) {\n        interactive.interactionsState[interaction.object.uuid].downFired = true;\n        if (interaction.onPointerDown !== undefined) {\n          interaction.onPointerDown(intersect);\n        }\n      }\n      if (firePointerUp(interaction)) {\n        interactive.interactionsState[interaction.object.uuid].upFired = true;\n        if (interaction.onPointerUp !== undefined) {\n          interaction.onPointerUp(intersect);\n          document.body.style.cursor = \"auto\";\n        }\n      }\n      if (firePointerMove(interaction)) {\n        if (interaction.onPointerMove !== undefined) {\n          interaction.onPointerMove(intersect);\n        }\n      }\n    }\n  },\n  update(\n    camera: THREE.PerspectiveCamera,\n    raycaster: THREE.Raycaster,\n    controllers: XRController[]\n  ) {\n    if (!interactive.enabled || interactive.disabled) return;\n\n    if (controllers.length > 0) {\n      for (let i = 0, length = controllers.length; i < length; i++) {\n        if (controllers[i].inputSource.handedness !== \"right\") continue;\n        const controller = controllers[i].controller;\n        matrix.identity().extractRotation(controller.matrixWorld);\n        raycaster.ray.origin.setFromMatrixPosition(controller.matrixWorld);\n        raycaster.ray.direction.set(0, 0, -1).applyMatrix4(matrix);\n      }\n      interactive.handle(camera, raycaster);\n    } else {\n      interactive.handle(camera, raycaster);\n    }\n\n    if (interactive.cleanUp && !interactive.pointerDown) {\n      interactive.cleanUp = false;\n      for (const uuid in interactive.interactionsState) {\n        if (!interactive.interactionsState.hasOwnProperty(uuid)) {\n          continue;\n        }\n        interactive.interactionsState[uuid].upFired = false;\n        interactive.interactionsState[uuid].downFired = false;\n      }\n    }\n\n    if (interactive.cleanDown && interactive.pointerDown) {\n      interactive.cleanDown = false;\n    }\n  },\n};\n\nexport default interactive;\n","import { RootState } from \"@react-three/fiber\";\nimport { XRController } from \"@react-three/xr\";\nimport interactive from \"./interactive\";\n\ntype Fn = (state: RootState) => void;\n\nconst updates = new Map<string, Fn>();\n\nexport default function update(state: RootState, controllers: XRController[]) {\n  updates.forEach((fn) => fn(state));\n  interactive.update(state.camera, state.raycaster, controllers);\n}\n\nupdate.add = (uuid: string, fn: Fn) => {\n  updates.set(uuid, fn);\n};\n\nupdate.remove = (uuid: string) => {\n  if (updates.has(uuid)) {\n    updates.delete(uuid);\n  }\n};\n","import React from \"react\";\nimport { BoxLineGeometry } from \"three/examples/jsm/geometries/BoxLineGeometry\";\nimport { useFrame } from \"@react-three/fiber\";\nimport {\n  DefaultXRControllers,\n  useXR,\n  VRCanvas as Canvas,\n} from \"@react-three/xr\";\nimport { OrbitControls, PerspectiveCamera } from \"@react-three/drei\";\nimport { update } from \"../../lib\";\n\ntype Props = {\n  children?: React.ReactNode;\n};\n\nfunction Scene({ children }: Props) {\n  const { controllers } = useXR();\n\n  useFrame((state) => {\n    update(state, controllers);\n  });\n\n  return <>{children}</>;\n}\n\nexport default function Example({ children }: Props) {\n  const room = React.useMemo(() => {\n    return new BoxLineGeometry(6, 6, 6, 10, 10, 10).translate(0, 3, 0);\n  }, []);\n\n  return (\n    <Canvas legacy flat linear gl={{ alpha: false }}>\n      {/** Background, cameras, controls and lights */}\n      <color args={[\"#333333\"]} attach=\"background\" />\n      <lineSegments geometry={room}>\n        <lineBasicMaterial color=\"#c0c0c0\" />\n      </lineSegments>\n      <PerspectiveCamera makeDefault position={[0, 1.6, 0]} />\n      <OrbitControls makeDefault target={[0, 1, -1.8]} />\n      <ambientLight />\n      <DefaultXRControllers />\n\n      <Scene>\n        <group position={[0, 1, -1.88]}>{children}</group>\n      </Scene>\n    </Canvas>\n  );\n}\n"],"names":["lastRenderOrder","LayerContext","React","parentUuid","currentChildren","addChild","removeChild","DEFAULT_BACKGROUND_POSITION","Layer","ref","zIndex","resolution","visible","autoLayout","width","height","opacity","backgroundColor","backgroundImage","backgroundSize","backgroundPosition","borderRadius","borderWidth","borderColor","flexDirection","alignItems","justifyContent","gap","textContent","textAlign","justifyText","verticalAlign","color","fontFamily","fontSize","fontWeight","childIndex","children","onPointerMove","onPointerOver","onPointerOut","onPointerDown","onPointerUp","props","renderOrder","groupRef","materialRef","childrenGroupRef","layerContext","uuid","THREE","index","interactive","object","current","ctx","document","createElement","getContext","canvas","Math","max","floor","canvasTexture","anisotropy","images","Image","src","update","w","h","d2r","PI","res","mapLinear","globalCompositeOperation","clearRect","isArray","Array","array","number","tl","tr","br","bl","beginPath","moveTo","lineTo","arc","closePath","globalAlpha","fillStyle","lineWidth","fill","ox","oy","undefined","x","y","sx","sy","sw","sh","ir","cr","dw","dh","dx","dy","save","clip","drawImage","restore","canvasTxt","min","textBaseline","stroke","strokeStyle","needsUpdate","updateManager","setCurrentChildren","childGroupRefs","map","size","refs","includes","reverse","forEach","length","childrenWidth","reduce","child","childrenHeight","contentSize","axis","axisInverted","i","spacing","layout","position","layerProviderValue","nextCurrentChildren","findIndex","value","push","sort","a","b","filter","childrenGroup","traverse","material","transparent","Provider","mergeRefs","args","side","depthWrite","key","ForwardedLayer","displayName","matrix","firePointerOver","interaction","interactionsState","overFired","firePointerOut","state","outFired","firePointerDown","pointerDown","downFired","firePointerUp","upFired","disabled","enabled","lastInteractionUuid","interactions","cleanUp","cleanDown","cleanMove","create","onMove","onDown","onUp","window","addEventListener","removeEventListener","add","hasPointerEvent","item","remove","splice","body","style","cursor","handle","camera","raycaster","intersects","intersectObject","intersect","controllers","inputSource","handedness","controller","identity","extractRotation","matrixWorld","ray","origin","setFromMatrixPosition","direction","set","applyMatrix4","hasOwnProperty","updates","Map","fn","has","delete","Scene","useXR","useFrame","Example","room","BoxLineGeometry","translate","legacy","flat","linear","gl","alpha","attach","geometry","makeDefault","target"],"sourceRoot":""}