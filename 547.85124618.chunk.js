"use strict";(self.webpackChunkreact_xr_ui=self.webpackChunkreact_xr_ui||[]).push([[547],{228:function(e,t,n){n.d(t,{Z:function(){return v}});var o=n(462),r=n(294),i=n(477),a=n(561),c=n.n(a),l=n(530);let u=-1;var s=n(513),d=n(71);const f=r.createContext({parentUuid:null,currentChildren:[],addChild(){},removeChild(){}}),m=[0,0];function h(e,t){let{zIndex:n=0,resolution:a=2048,visible:h=!0,autoLayout:p=!0,width:v=1,height:g=1,opacity:w=1,backgroundColor:b="transparent",backgroundImage:y,backgroundSize:x,backgroundPosition:E=m,borderRadius:M=0,borderWidth:P=0,borderColor:j="transparent",flexDirection:C="row",alignItems:S="center",justifyContent:D="center",gap:k=0,textContent:F,textAlign:I="left",justifyText:U=!1,verticalAlign:O="top",color:Z="white",fontFamily:L="system-ui, sans-serif",fontSize:R=.1,fontWeight:T="normal",childIndex:z,children:W,onPointerMove:A,onPointerOver:B,onPointerOut:_,onPointerDown:H,onPointerUp:G,...N}=e;const V=r.useMemo((()=>++u),[]),q=r.useRef(null),J=r.useRef(null),K=r.useRef(null),Q=r.useContext(f),X=r.useMemo((()=>i.MathUtils.generateUUID()),[]);r.useEffect((()=>{if(null!==Q.parentUuid)return Q.addChild({width:v,height:g,index:z,uuid:X}),()=>{Q.removeChild(X)}}),[v,g,z,Q.parentUuid]),r.useEffect((()=>{d.Z.add({uuid:X,object:q.current,onPointerMove:A,onPointerOver:B,onPointerOut:_,onPointerDown:H,onPointerUp:G})}),[X,A,B,_,H,G]),r.useEffect((()=>()=>{d.Z.remove(X)}),[X]);const Y=r.useMemo((()=>document.createElement("canvas").getContext("2d")),[]);r.useMemo((()=>{Y.canvas.width=Math.max(1,Math.floor(v*a)),Y.canvas.height=Math.max(1,Math.floor(g*a))}),[Y.canvas,v,g,a]);const $=r.useMemo((()=>{const e=new i.CanvasTexture(Y.canvas);return e.anisotropy=16,e}),[Y.canvas,v,g]),ee=r.useMemo((()=>({backgroundImage:new Image})),[]);r.useMemo((()=>{y&&(ee.backgroundImage.src=y)}),[ee.backgroundImage,y]);const te=r.useCallback((()=>{const e=Y.canvas.width,t=Y.canvas.height,n=Math.PI/180,o=(e+t)/2,{mapLinear:r}=i.MathUtils;Y.globalCompositeOperation="source-over",Y.clearRect(0,0,e,t);{const r=Array.isArray(M),i=M,a=M;let[c=0,l=0,u=0,s=0]=r?i:[a,a,a,a];c*=o,l*=o,u*=o,s*=o,Y.beginPath(),Y.moveTo(c,0),Y.lineTo(e-l,0),Y.arc(e-l,l,l,270*n,360*n),Y.lineTo(e,t-u),Y.arc(e-u,t-u,u,0,90*n),Y.lineTo(s,t),Y.arc(s,t-s,s,90*n,180*n),Y.lineTo(0,c),Y.arc(c,c,c,180*n,270*n),Y.closePath()}Y.globalAlpha=w,Y.fillStyle=b,Y.lineWidth=P*o*2,Y.fill();const a=P*o,l=P*o;if(void 0!==y){const n=E[0],o=E[1],i=0,c=0,u=ee.backgroundImage.width,s=ee.backgroundImage.height,d=u/s,f=e/t;let m=u,h=s;switch(x){case"stretch":m=e,h=t;break;case"contain":m=e-2*a,h=t-2*l,d>f?h=m/d:m=h*d;break;case"cover":m=e-2*a,h=t-2*l,d<f?h=m/d:m=h*d}const p=a+r(n,0,1,0,e-2*a-m),v=l+r(o,0,1,0,t-2*l-h);Y.save(),Y.clip(),Y.drawImage(ee.backgroundImage,i,c,u,s,p,v,m,h),Y.restore()}void 0!==F&&(c().font=L,c().fontSize=R*Math.min(e,t),c().lineHeight=null,c().align=I,c().vAlign=O,c().justify=U,c().fontWeight=T,Y.textBaseline="bottom",Y.fillStyle=Z,c().drawText(Y,F,a,l,e-2*a,t-2*l)),Y.globalCompositeOperation="destination-out",Y.stroke(),Y.globalCompositeOperation="source-over",Y.save(),Y.clip(),Y.strokeStyle=j,Y.stroke(),Y.restore(),$.needsUpdate=!0}),[Y,ee,P,M,j,y,b,E,x,$,T,R,L,R,D,O,I,F,Z]);r.useEffect((()=>(s.Z.add(X,te),()=>s.Z.remove(X))),[X,te]);const[ne,oe]=r.useState([]),re=r.useMemo((()=>ne.map((()=>r.createRef()))),[ne]);r.useEffect((()=>{const e={width:v,height:g};e.width-=2*P,e.height-=2*P;let t=[...re];["column","row-reverse"].includes(C)&&t.reverse(),t.forEach(((n,o)=>{"column"===C&&(o=t.length-1-o);const[r,i]=function(e){let{currentChildren:t,index:n,flexDirection:o,alignItems:r,justifyContent:i,gap:a,size:c}=e;const l=t.reduce(((e,t)=>e+t.width),0),u=t.reduce(((e,t)=>e+t.height),0);let s=0,d=0,f=l,m="width",h="height";if(["column","column-reverse"].includes(o)&&(m="height",h="width",f=u),t.length>0&&!["space-between","space-around"].includes(i)&&(f+=a*(t.length-1)),"start"===i){s=.5*c[m]+.5*t[0][m]-c[m],"column"===o&&(s=.5*c[m]+.5*t[0][m]-f);for(let e=1;e<=n;e++)s+=.5*t[e-1][m]+.5*t[e][m]+a}if("center"===i){s=.5*t[0][m]-.5*f;for(let e=1;e<=n;e++)s+=.5*t[e-1][m]+.5*t[e][m]+a}if("end"===i){s=.5*c[m]+.5*t[0][m]-f,"column"===o&&(s=.5*c[m]+.5*t[0][m]-c[m]);for(let e=1;e<=n;e++)s+=.5*t[e-1][m]+.5*t[e][m]+a}if("space-between"===i)if(f>=c[m]){s=.5*c[m]+.5*t[0][m]-c[m];for(let e=1;e<=n;e++)s+=.5*t[e-1][m]+.5*t[e][m]}else{let e=Math.max(0,c[m]-f);0===t.length?e=0:e>0&&(e/=t.length-1),s=.5*c[m]+.5*t[0][m]-c[m];for(let o=1;o<=n;o++)s+=.5*t[o-1][m]+.5*t[o][m]+e}if("space-around"===i)if(f>=c[m]){s=.5*c[m]+.5*t[0][m]-c[m];for(let e=1;e<=n;e++)s+=.5*t[e-1][m]+.5*t[e][m]}else{let e=Math.max(0,c[m]-f);0===t.length?e=0:e>0&&(e/=t.length+1),s=.5*c[m]+.5*t[0][m]-c[m],s+=e;for(let o=1;o<=n;o++)s+=.5*t[o-1][m]+.5*t[o][m]+e}return"start"===r&&(["row","row-reverse"].includes(o)&&(d=.5*c[h]-.5*t[n][h]),["column","column-reverse"].includes(o)&&(d=-.5*c[h]+.5*t[n][h])),"end"===r&&(["row","row-reverse"].includes(o)&&(d=-.5*c[h]+.5*t[n][h]),["column","column-reverse"].includes(o)&&(d=.5*c[h]-.5*t[n][h])),["column","column-reverse"].includes(o)?[d,s]:[s,d]}({currentChildren:ne,index:o,flexDirection:C,alignItems:S,justifyContent:D,gap:k,size:e});n.current.position.x=r,n.current.position.y=i}))}),[re,ne,v,g,C,S,D,P,k]);const ie=r.useMemo((()=>({currentChildren:ne,parentUuid:X,addChild(e){oe((t=>{const n=[...t],o=t.findIndex((t=>t.uuid===e.uuid));return-1===o?n.push({...e}):n[o]={...e},n.sort(((e,t)=>e.index-t.index))}))},removeChild(e){oe((t=>t.filter((t=>t.uuid!==e))))}})),[ne,X]);return r.useEffect((()=>{const e=K.current;null!==e&&e.traverse((e=>{e instanceof i.Mesh&&e.material instanceof i.Material&&(e.material.transparent=!0,e.material.opacity=w,e.material.needsUpdate=!0)}))}),[w]),r.createElement(f.Provider,{value:ie},r.createElement("group",(0,o.Z)({ref:(0,l.l)([t,q])},N,{visible:h}),r.createElement("mesh",{renderOrder:V+n},r.createElement("planeBufferGeometry",{args:[v,g]}),r.createElement("meshBasicMaterial",{ref:J,side:i.FrontSide,opacity:w,transparent:!0,depthWrite:!1,map:$})),r.createElement("group",{renderOrder:V+n+1,ref:K},r.Children.map(W,((e,t)=>r.isValidElement(e)?r.createElement("group",{key:t,ref:re[t]},r.cloneElement(e,{...e.props,childIndex:t})):e)))))}const p=r.forwardRef(h);p.displayName="layer";var v=p},71:function(e,t,n){const o=new(n(477).Matrix4);function r(e){if(e.object)return!l.interactionsState[e.object.uuid].overFired}function i(e){if(!e.object)return;const t=l.interactionsState[e.object.uuid];return t.overFired&&!t.outFired}function a(e){return!!l.pointerDown&&(e.object?!l.interactionsState[e.object.uuid].downFired:void 0)}function c(e){if(l.pointerDown)return!1;if(!e.object)return;const t=l.interactionsState[e.object.uuid];return t.downFired&&!t.upFired}const l={disabled:!1,enabled:!0,lastInteractionUuid:"",interactions:[],interactionsState:{},pointerDown:!1,cleanUp:!1,cleanDown:!1,cleanMove:!1,create(){function e(){l.enabled=!0,l.cleanMove=!0}function t(){l.enabled=!0,l.pointerDown=!0,l.cleanDown=!0}function n(){l.pointerDown=!1,l.cleanUp=!0}return window.addEventListener("pointermove",e),window.addEventListener("pointerdown",t),window.addEventListener("pointerup",n),()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerdown",t),window.removeEventListener("pointerup",n)}},add(e){(function(e){return void 0!==e.onPointerMove||void 0!==e.onPointerOver||void 0!==e.onPointerOut||void 0!==e.onPointerDown||void 0!==e.onPointerUp})(e)&&-1===l.interactions.findIndex((t=>{var n,o;return(null===(n=t.object)||void 0===n?void 0:n.uuid)===(null===(o=e.object)||void 0===o?void 0:o.uuid)}))&&e.object&&(l.interactionsState[e.object.uuid]={downFired:!1,upFired:!1,overFired:!1,outFired:!1},l.interactions.push(e))},remove(e){const t=l.interactions.findIndex((t=>t.uuid===e));t>-1&&(l.interactions.splice(t,1),document.body.style.cursor="auto")},handle(e,t){for(let e=0,n=l.interactions.length;e<n;e++){const n=l.interactions[e];if(!n.object)continue;const o=t.intersectObject(n.object,!0);if(0===o.length){i(n)&&(l.interactionsState[n.object.uuid].outFired=!0,l.interactionsState[n.object.uuid].overFired=!1,void 0!==n.onPointerOut&&(n.onPointerOut(),document.body.style.cursor="auto"));continue}const u=o[0];r(n)&&(l.interactionsState[n.object.uuid].overFired=!0,l.interactionsState[n.object.uuid].outFired=!1,void 0!==n.onPointerOver&&(n.onPointerOver(u),document.body.style.cursor="pointer")),a(n)&&(l.interactionsState[n.object.uuid].downFired=!0,void 0!==n.onPointerDown&&n.onPointerDown(u)),c(n)&&(l.interactionsState[n.object.uuid].upFired=!0,void 0!==n.onPointerUp&&(n.onPointerUp(u),document.body.style.cursor="auto")),void 0!==n.onPointerMove&&n.onPointerMove(u)}},update(e,t,n){if(l.enabled&&!l.disabled){if(n.length>0){for(let e=0,r=n.length;e<r;e++){if("right"!==n[e].inputSource.handedness)continue;const r=n[e].controller;o.identity().extractRotation(r.matrixWorld),t.ray.origin.setFromMatrixPosition(r.matrixWorld),t.ray.direction.set(0,0,-1).applyMatrix4(o)}l.handle(e,t)}else l.handle(e,t);if(l.cleanUp&&!l.pointerDown){l.cleanUp=!1;for(const e in l.interactionsState)l.interactionsState.hasOwnProperty(e)&&(l.interactionsState[e].upFired=!1,l.interactionsState[e].downFired=!1)}l.cleanDown&&l.pointerDown&&(l.cleanDown=!1)}}};t.Z=l},513:function(e,t,n){n.d(t,{Z:function(){return i}});var o=n(71);const r=new Map;function i(e,t){r.forEach((t=>t(e))),o.Z.update(e.camera,e.raycaster,t)}i.add=(e,t)=>{r.set(e,t)},i.remove=e=>{r.has(e)&&r.delete(e)}},291:function(e,t,n){n.d(t,{Z:function(){return h}});var o=n(294),r=n(369),i=n(149),a=n(972),c=n(96),l=n(846),u=n(989),s=n(581),d=n(513),f=n(71);function m(e){let{children:t}=e;const{controllers:n}=(0,a.nH)();return(0,i.x)((e=>{(0,d.Z)(e,n)})),o.useEffect((()=>f.Z.create()),[]),(0,c.c)("selectstart",(()=>{f.Z.enabled=!0,f.Z.pointerDown=!0,f.Z.cleanDown=!0})),(0,c.c)("selectend",(()=>{f.Z.pointerDown=!1,f.Z.cleanUp=!0})),o.createElement(o.Fragment,null,t)}function h(e){let{children:t}=e;const n=o.useMemo((()=>new r.d(6,6,6,10,10,10).translate(0,3,0)),[]);return o.createElement(a.de,{legacy:!0,flat:!0,linear:!0,gl:{alpha:!1}},o.createElement("color",{args:["#333333"],attach:"background"}),o.createElement("lineSegments",{geometry:n},o.createElement("lineBasicMaterial",{color:"#c0c0c0"})),o.createElement(u.c,{makeDefault:!0,position:[0,1.6,0]}),o.createElement(s.z,{makeDefault:!0,target:[0,1,-1.8]}),o.createElement("ambientLight",null),o.createElement(l.M,null),o.createElement(m,null,o.createElement("group",{position:[0,1,-1.88]},t)))}}}]);
//# sourceMappingURL=547.85124618.chunk.js.map