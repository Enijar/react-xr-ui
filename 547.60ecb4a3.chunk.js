"use strict";(self.webpackChunkreact_xr_ui=self.webpackChunkreact_xr_ui||[]).push([[547],{228:function(e,t,n){n.d(t,{Z:function(){return m}});var o=n(462),r=n(294),i=n(477),a=n(561),c=n.n(a);let u=-1;var l=n(513),s=n(71);const d=r.createContext({parentUuid:null,parentSize:{width:1,height:1},currentChildren:[],addChild(){},removeChild(){}}),h=[0,0];function p(e,t){let{zIndex:n=0,resolution:a=1024,visible:p=!0,autoLayout:m=!0,width:f,height:v,opacity:g=1,backgroundColor:w="transparent",backgroundImage:b,backgroundSize:y,backgroundPosition:P=h,padding:M=0,borderRadius:x=0,borderWidth:E=0,borderColor:S="transparent",flexDirection:k="row",alignItems:C="center",justifyContent:D="center",gap:j=0,textContent:U,textAlign:F="left",justifyText:O=!1,verticalAlign:I="top",color:Z="white",fontFamily:z="system-ui, sans-serif",fontSize:L=.1,fontWeight:A="normal",lineHeight:R=null,childIndex:T,children:W,onPointerMove:B,onPointerOver:H,onPointerOut:N,onPointerDown:_,onPointerUp:X,...G}=e;const V=r.useMemo((()=>++u),[]),q=r.useRef(null),J=r.useRef(null),K=r.useRef(null);r.useEffect((()=>{const e=J.current;null!==e&&(e.blending=i.CustomBlending)}),[]),r.useImperativeHandle(t,(()=>({group:q.current,test(){console.log("Test")}})));const Q=r.useContext(d),Y=r.useMemo((()=>{const e={width:1,height:1};if("string"==typeof f){const t=parseFloat(f);null===Q.parentUuid?e.width=t/100:isNaN(t)?e.width=1:e.width=Q.parentSize.width*(t/100)}else e.width=null!=f?f:1;if("string"==typeof v){const t=parseFloat(v);null===Q.parentUuid?e.height=t/100:isNaN(t)?e.height=1:e.height=Q.parentSize.height*(t/100)}else e.height=null!=v?v:1;return e}),[f,v,Q.parentUuid,Q.parentSize]),$=r.useMemo((()=>i.MathUtils.generateUUID()),[]);r.useEffect((()=>{if(null!==Q.parentUuid)return Q.addChild({width:Y.width,height:Y.height,index:T,autoLayout:m,uuid:$}),()=>{Q.removeChild($)}}),[Y,T,m,Q.parentUuid]);const ee=r.useRef({onPointerMove:B,onPointerOver:H,onPointerOut:N,onPointerDown:_,onPointerUp:X});r.useMemo((()=>{ee.current.onPointerMove=B,ee.current.onPointerOver=H,ee.current.onPointerOut=N,ee.current.onPointerDown=_,ee.current.onPointerUp=X}),[B,H,N,_,X]),r.useLayoutEffect((()=>(s.Z.add({uuid:$,object:q.current,onPointerMove:ee.current.onPointerMove,onPointerOver:ee.current.onPointerOver,onPointerOut:ee.current.onPointerOut,onPointerDown:ee.current.onPointerDown,onPointerUp:ee.current.onPointerUp}),()=>{s.Z.remove($)})),[$]);const te=r.useMemo((()=>document.createElement("canvas").getContext("2d")),[]);r.useMemo((()=>{te.canvas.width=Math.max(1,Math.floor(Y.width*a)),te.canvas.height=Math.max(1,Math.floor(Y.height*a))}),[te.canvas,Y,a]);const ne=r.useMemo((()=>{const e=new i.CanvasTexture(te.canvas);return e.anisotropy=16,e.premultiplyAlpha=!0,e}),[te.canvas,Y]),oe=r.useMemo((()=>({backgroundImage:new Image})),[]);r.useMemo((()=>{b&&(oe.backgroundImage.src=b)}),[oe.backgroundImage,b]);const re=r.useCallback((()=>{const e=te.canvas.width,t=te.canvas.height,n=Math.PI/180,o=Math.min(e,t),{mapLinear:r}=i.MathUtils;te.globalCompositeOperation="source-over",te.clearRect(0,0,e,t);{const r=Array.isArray(x),i=x,a=x;let[c=0,u=0,l=0,s=0]=r?i:[a,a,a,a];c*=o,u*=o,l*=o,s*=o,te.beginPath(),te.moveTo(c,0),te.lineTo(e-u,0),te.arc(e-u,u,u,270*n,360*n),te.lineTo(e,t-l),te.arc(e-l,t-l,l,0,90*n),te.lineTo(s,t),te.arc(s,t-s,s,90*n,180*n),te.lineTo(0,c),te.arc(c,c,c,180*n,270*n),te.closePath()}te.globalAlpha=g,te.fillStyle=w,te.lineWidth=E*o*2,te.fill();const a=E*o,u=E*o;if(void 0!==b){const n=P[0],o=P[1],i=0,c=0,l=Math.max(1,oe.backgroundImage.width),s=Math.max(1,oe.backgroundImage.height),d=l/s,h=e/t;let p=l,m=s;switch(y){case"stretch":p=e,m=t;break;case"contain":p=e-2*a,m=t-2*u,d>=h?m=p/d:p=m*d;break;case"cover":p=e-2*a,m=t-2*u,d<=h?m=p/d:p=m*d}const f=a+r(n,0,1,0,e-2*a-p),v=u+r(o,0,1,0,t-2*u-m);te.save(),te.clip(),te.drawImage(oe.backgroundImage,i,c,l,s,f,v,p,m),te.restore()}void 0!==U&&(c().font=z,c().fontSize=L*Math.min(e,t),c().lineHeight=R*c().fontSize,c().align=F,c().vAlign=I,c().justify=O,c().fontWeight=A,te.textBaseline="bottom",te.fillStyle=Z,c().drawText(te,U,a,u,e-2*a,t-2*u)),te.globalCompositeOperation="destination-out",te.stroke(),te.globalCompositeOperation="source-over",te.save(),te.clip(),te.strokeStyle=S,te.stroke(),te.restore(),ne.needsUpdate=!0}),[te,oe,E,x,S,b,w,P,y,ne,A,L,z,L,R,D,I,F,U,Z]);r.useEffect((()=>(l.Z.add($,re),()=>l.Z.remove($))),[$,re]);const[ie,ae]=r.useState([]),ce=r.useMemo((()=>ie.map((()=>r.createRef()))),[ie]);r.useEffect((()=>{var e,t,n,o;const r=Math.min(Y.width,Y.height),i=Array.isArray(M)?(null!==(e=M[1])&&void 0!==e?e:0)+(null!==(t=M[3])&&void 0!==t?t:0):M,a=Array.isArray(M)?(null!==(n=M[0])&&void 0!==n?n:0)+(null!==(o=M[2])&&void 0!==o?o:0):M;Y.width-=r*E*2,Y.height-=r*E*2,Y.width-=r*i*2,Y.height-=r*a*2,ce.forEach(((e,t)=>{let[n,o]=function(e){let{currentChildren:t,index:n,flexDirection:o,alignItems:r,justifyContent:i,gap:a,size:c}=e;const u=t.reduce(((e,t)=>t.autoLayout?e+t.width:e),0),l=t.reduce(((e,t)=>t.autoLayout?e+t.height:e),0);let s=0,d=0,h=u,p="width",m="height";["column","column-reverse"].includes(o)&&(p="height",m="width",h=l),t.length>0&&!["space-between","space-around"].includes(i)&&(h+=a*(t.length-1)),["space-between","space-around"].includes(i)&&(a=0);const f=["row-reverse","column-reverse"].includes(o);let v=1;switch(["column","column-reverse"].includes(o)&&(v=-1),i){case"start":s=(.5*(c[p]-t[n][p])-(c[p]-h))*v;break;case"end":s=(.5*c[p]-.5*t[n][p])*v;break;case"center":s=(.5*h-.5*t[n][p])*v;break;case"space-between":case"space-around":t.length>1&&(s=(.5*c[p]-.5*t[n][p])*v)}let g=0;if(t.length>1&&("space-between"===i&&(g=Math.max(0,c[p]-h)/Math.max(1,t.length-1)),"space-around"===i&&(g=Math.max(0,c[p]-h)/Math.max(1,t.length+1))),"space-around"===i&&(s-=g*v),f)for(let e=1;e<=n;e++){const n=t[e-1];n.autoLayout&&(s-=(n[p]+g+a)*v)}else for(let e=t.length-2;e>=n;e--)t[e+1].autoLayout&&(s-=(t[e+1][p]+g+a)*v);switch(r){case"start":d=(.5*c[m]-.5*t[n][m])*v;break;case"end":d=(.5*t[n][m]-.5*c[m])*v;break;case"center":d=0}return["column","column-reverse"].includes(o)?[d,s]:[s,d]}({currentChildren:ie,index:t,flexDirection:k,alignItems:C,justifyContent:D,gap:j,size:Y});ie[t].autoLayout||(n=0,o=0),e.current.position.x=n,e.current.position.y=o}))}),[ce,ie,Y,k,C,D,E,M,j]);const ue=r.useMemo((()=>({currentChildren:ie,parentSize:Y,parentUuid:$,addChild(e){ae((t=>{const n=[...t],o=t.findIndex((t=>t.uuid===e.uuid));return-1===o?n.push({...e}):n[o]={...e},n.sort(((e,t)=>e.index-t.index))}))},removeChild(e){ae((t=>t.filter((t=>t.uuid!==e))))}})),[ie,$,Y]);return r.useEffect((()=>{const e=K.current;null!==e&&e.traverse((e=>{e instanceof i.Mesh&&e.material instanceof i.Material&&(e.material.transparent=!0,e.material.opacity=g,e.material.needsUpdate=!0)}))}),[g]),r.createElement(d.Provider,{value:ue},r.createElement("group",(0,o.Z)({ref:q},G,{visible:p}),r.createElement("mesh",{renderOrder:V+n},r.createElement("planeGeometry",{args:[Y.width,Y.height]}),r.createElement("meshBasicMaterial",{ref:J,side:i.FrontSide,opacity:g,transparent:!0,depthWrite:!1,map:ne})),r.createElement("group",{renderOrder:V+n+1,ref:K},r.Children.map(W,((e,t)=>r.isValidElement(e)?r.createElement("group",{key:t,ref:ce[t]},r.cloneElement(e,{...e.props,childIndex:t})):e)))))}var m=r.forwardRef(p)},71:function(e,t,n){const o=new(n(477).Matrix4);function r(e){if(e.object)return!u.interactionsState[e.object.uuid].overFired}function i(e){if(!e.object)return;const t=u.interactionsState[e.object.uuid];return t.overFired&&!t.outFired}function a(e){return!!u.pointerDown&&(e.object?!u.interactionsState[e.object.uuid].downFired:void 0)}function c(e){if(u.pointerDown)return!1;if(!e.object)return;const t=u.interactionsState[e.object.uuid];return t.downFired&&!t.upFired}const u={disabled:!1,enabled:!0,lastInteractionUuid:"",interactions:[],interactionsState:{},pointerDown:!1,cleanUp:!1,cleanDown:!1,cleanMove:!1,create(){function e(){u.enabled=!0,u.cleanMove=!0}function t(){u.enabled=!0,u.pointerDown=!0,u.cleanDown=!0}function n(){u.pointerDown=!1,u.cleanUp=!0}return window.addEventListener("pointermove",e),window.addEventListener("pointerdown",t),window.addEventListener("pointerup",n),()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerdown",t),window.removeEventListener("pointerup",n)}},add(e){(function(e){return void 0!==e.onPointerMove||void 0!==e.onPointerOver||void 0!==e.onPointerOut||void 0!==e.onPointerDown||void 0!==e.onPointerUp})(e)&&-1===u.interactions.findIndex((t=>{var n,o;return(null===(n=t.object)||void 0===n?void 0:n.uuid)===(null===(o=e.object)||void 0===o?void 0:o.uuid)}))&&e.object&&(u.interactionsState[e.object.uuid]={downFired:!1,upFired:!1,overFired:!1,outFired:!1},u.interactions.push(e))},remove(e){const t=u.interactions.findIndex((t=>t.uuid===e));t>-1&&(u.interactions.splice(t,1),document.body.style.cursor="auto")},handle(e,t){for(let e=0,n=u.interactions.length;e<n;e++){const n=u.interactions[e];if(!n.object)continue;const o=t.intersectObject(n.object,!0);if(0===o.length){i(n)&&(u.interactionsState[n.object.uuid].outFired=!0,u.interactionsState[n.object.uuid].overFired=!1,void 0!==n.onPointerOut&&(n.onPointerOut(),document.body.style.cursor="auto"));continue}const l=o[0];r(n)&&(u.interactionsState[n.object.uuid].overFired=!0,u.interactionsState[n.object.uuid].outFired=!1,void 0!==n.onPointerOver&&(n.onPointerOver(l),document.body.style.cursor="pointer")),a(n)&&(u.interactionsState[n.object.uuid].downFired=!0,void 0!==n.onPointerDown&&n.onPointerDown(l)),c(n)&&(u.interactionsState[n.object.uuid].upFired=!0,void 0!==n.onPointerUp&&(n.onPointerUp(l),document.body.style.cursor="auto")),void 0!==n.onPointerMove&&n.onPointerMove(l)}},update(e,t,n){if(u.enabled&&!u.disabled){if(n.length>0){for(let e=0,r=n.length;e<r;e++){if("right"!==n[e].inputSource.handedness)continue;const r=n[e].controller;o.identity().extractRotation(r.matrixWorld),t.ray.origin.setFromMatrixPosition(r.matrixWorld),t.ray.direction.set(0,0,-1).applyMatrix4(o)}u.handle(e,t)}else u.handle(e,t);if(u.cleanUp&&!u.pointerDown){u.cleanUp=!1;for(const e in u.interactionsState)u.interactionsState.hasOwnProperty(e)&&(u.interactionsState[e].upFired=!1,u.interactionsState[e].downFired=!1)}u.cleanDown&&u.pointerDown&&(u.cleanDown=!1)}}};t.Z=u},513:function(e,t,n){n.d(t,{Z:function(){return i}});var o=n(71);const r=new Map;function i(e,t){r.forEach((t=>t(e))),o.Z.update(e.camera,e.raycaster,t)}i.add=(e,t)=>{r.set(e,t)},i.remove=e=>{r.has(e)&&r.delete(e)}},291:function(e,t,n){n.d(t,{Z:function(){return f}});var o=n(294),r=n(369),i=n(738),a=n(977),c=n(747),u=n(96),l=n(521),s=n(989),d=n(581),h=n(513),p=n(71);function m(e){let{children:t}=e;const n=(0,c.nH)((e=>e.controllers));return(0,i.z)((e=>{(0,h.Z)(e,n)})),o.useEffect((()=>p.Z.create()),[]),(0,u.c)("selectstart",(()=>{p.Z.enabled=!0,p.Z.pointerDown=!0,p.Z.cleanDown=!0})),(0,u.c)("selectend",(()=>{p.Z.pointerDown=!1,p.Z.cleanUp=!0})),o.createElement(o.Fragment,null,t)}function f(e){let{children:t}=e;const n=o.useMemo((()=>new r.d(6,6,6,10,10,10).translate(0,3,0)),[]);return o.createElement(a.Xz,{legacy:!0,flat:!0,linear:!0,gl:{alpha:!1}},o.createElement(c.XR,null,o.createElement("color",{args:["#333333"],attach:"background"}),o.createElement("lineSegments",{geometry:n},o.createElement("lineBasicMaterial",{color:"#c0c0c0"})),o.createElement(s.c,{makeDefault:!0,position:[0,1.6,0]}),o.createElement(d.z,{makeDefault:!0,target:[0,1,-1.8]}),o.createElement("ambientLight",null),o.createElement(l.z,null),o.createElement(m,null,o.createElement("group",{position:[0,1,-1.88]},t))))}}}]);
//# sourceMappingURL=547.60ecb4a3.chunk.js.map